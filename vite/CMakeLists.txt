

find_program(NPM_COMMAND npm)


if (CMAKE_BUILD_TYPE MATCHES Debug)
   set(BUILD_REACT "echo")
   set(BUILD_REACT_ARGS Skipping react debug build)
else()
    set(BUILD_REACT npm)
    set(BUILD_REACT_ARGS run build)
endif()

set (BUILD_DIRECTORY ${PROJECT_SOURCE_DIR}/dist)


add_custom_command(
    OUTPUT ${BUILD_DIRECTORY}/index.html
    COMMAND ${BUILD_REACT}
    ARGS  ${BUILD_REACT_ARGS}
    WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}/vite

    DEPENDS 
    # find public src *.json *.ts  -type f >/tmp/tmp.txt                    
    public/vite.svg
    public/robots.txt
    public/css/roboto.css
    public/iso_codes.json
    public/serve.json
    public/var/current_pedalboard.json
    public/var/config.json
    public/var/uiplugins.json
    public/var/plugin_classes.json
    public/logo512.png
    public/img/fx_delay.svg
    public/img/fx_error.svg
    public/img/fx_parametric_eq.svg
    public/img/fx_simulator.svg
    public/img/fx_lr.svg
    public/img/fx_plugin.svg
    public/img/fx_flanger2.svg
    public/img/fx_phaser.svg
    public/img/ic_bank.svg
    public/img/ic_drawer.svg
    public/img/Pi-Logo-3.png
    public/img/fx_constant.svg
    public/img/ic_drawer_2.png
    public/img/Pi-Logo-3.svg
    public/img/fx_split_a.svg
    public/img/fx_chorus.svg
    public/img/fx_split_b.svg
    public/img/fx_terminal.svg
    public/img/fx_spectral.svg
    public/img/settings_black_24dp.svg
    public/img/fx_analyzer.svg
    public/img/fx_oscillator.svg
    public/img/fx_generator.svg
    public/img/edit_banks.svg
    public/img/delete_outline_black_24dp.svg
    public/img/old_delete_outline_white_24dp.svg
    public/img/fx_converter.svg
    public/img/settings_white_24dp.svg
    public/img/ic_drawer_2.svg
    public/img/vst.png
    public/img/edit_banks_white.svg
    public/img/fx_pitch.svg
    public/img/fx_spatial.svg
    public/img/old_delete_outline_black_24dp.svg
    public/img/fx_limiter.svg
    public/img/vst.svg
    public/img/ic_navigate_before.svg
    public/img/cc-by.png
    public/img/fx_gate.svg
    public/img/ic_presets.svg
    public/img/fx_modulator.svg
    public/img/fx_filter_hp.svg
    public/img/VST_Logo_Steinberg.png
    public/img/fx_dial.svg
    public/img/VST_Logo_Steinberg.ico
    public/img/cx_mono.svg
    public/img/ic_navigate_next.svg
    public/img/fx_instrument.svg
    public/img/fx_flanger.svg
    public/img/fx_empty.svg
    public/img/fx_mixer.svg
    public/img/cx_stereo.svg
    public/img/ic_logo.svg
    public/img/fx_compressor.svg
    public/img/fx_amplifier.svg
    public/img/fx_filter.svg
    public/img/fx_eq.svg
    public/img/fx_utility.svg
    public/img/fx_function.svg
    public/img/fx_reverb.svg
    public/img/fx_distortion.svg
    public/img/ic_presets_white.svg
    public/manifest.json
    public/logo192.png
    public/sample_lv2_plugins.json
    public/fonts/Roboto-Thin.woff2
    public/fonts/LICENSE.txt
    public/fonts/Roboto-Italic.woff2
    public/fonts/Roboto-BoldItalic.woff2
    public/fonts/Roboto-Black.woff2
    public/fonts/Roboto-ThinItalic.woff2
    public/fonts/Roboto-BlackItalic.woff2
    public/fonts/Roboto-MediumItalic.woff2
    public/fonts/Roboto-Medium.woff2
    public/fonts/Roboto-LightItalic.woff2
    public/fonts/Roboto-Regular.woff2
    public/fonts/Roboto-Bold.woff2
    public/fonts/Roboto-Light.woff2
    public/favicon.ico
    public/index.html
    src/main.tsx
    src/index.css
    src/assets/react.svg
    src/vite-env.d.ts
    src/App.tsx
    src/pipedal/MainPage.tsx
    src/pipedal/ColorDropdownButton.tsx
    src/pipedal/AppThemed.tsx
    src/pipedal/ModFileTypes.tsx
    src/pipedal/ChannelBindingsHelpDialog.tsx
    src/pipedal/SplitUiControls.tsx
    src/pipedal/RadioSelectDialog.tsx
    src/pipedal/Pedal.tsx
    src/pipedal/WindowScale.tsx
    src/pipedal/MidiChannelBindingDialog.tsx
    src/pipedal/BankDialog.tsx
    src/pipedal/IControlViewFactory.tsx
    src/pipedal/Pedalboard.tsx
    src/pipedal/Lv2Plugin.tsx
    src/pipedal/WifiConfigDialog.tsx
    src/pipedal/GxTunerControl.tsx
    src/pipedal/ControlTooltip.tsx
    src/pipedal/StringBuilder.tsx
    src/pipedal/UploadFileDialog.tsx
    src/pipedal/FilePropertyDirectorySelectDialog.tsx
    src/pipedal/ObservableProperty.tsx
    src/pipedal/OldDeleteIcon.tsx
    src/pipedal/OkCancelDialog.tsx
    src/pipedal/PluginControl.tsx
    src/pipedal/WifiDirectConfigSettings.tsx
    src/pipedal/FullScreenIME.tsx
    src/pipedal/WifiConfigSettings.tsx
    src/pipedal/JackServerSettingsDialog.tsx
    src/pipedal/Utility.tsx
    src/pipedal/SelectChannelsDialog.tsx
    src/pipedal/AlsaDeviceInfo.tsx
    src/pipedal/LoadPluginDialog.tsx
    src/pipedal/PiPedalModel.tsx
    src/pipedal/SelectThemeDialog.tsx
    src/pipedal/ResizeResponsiveComponent.tsx
    src/pipedal/FilePropertyControl.tsx
    src/pipedal/NumericInput.tsx
    src/pipedal/MidiBinding.tsx
    src/pipedal/GovernorSettings.tsx
    src/pipedal/SnapshotPanel.tsx
    src/pipedal/PedalboardView.tsx
    src/pipedal/ToobSpectrumAnalyzerView.tsx
    src/pipedal/ToobMLView.tsx
    src/pipedal/MaterialColors.tsx
    src/pipedal/ZoomedUiControl.tsx
    src/pipedal/TemporaryDrawer.tsx
    src/pipedal/WifiChannel.tsx
    src/pipedal/MidiChannelBinding.tsx
    src/pipedal/SystemMidiBindingView.tsx
    src/pipedal/SelectMidiChannelsDialog.tsx
    src/pipedal/Banks.tsx
    src/pipedal/SelectHoverBackground.tsx
    src/pipedal/ToobWaveShapeView.tsx
    src/pipedal/PluginPresetSelector.tsx
    src/pipedal/PluginOutputControl.tsx
    src/pipedal/Rect.tsx
    src/pipedal/JackStatusView.tsx
    src/pipedal/JackHostStatus.tsx
    src/pipedal/PluginClass.tsx
    src/pipedal/VuMeter.tsx
    src/pipedal/svg/fx_delay.svg
    src/pipedal/svg/fx_error.svg
    src/pipedal/svg/old_delete_outline_24dp.svg
    src/pipedal/svg/drive_file_rename_outline_black_24dp.svg
    src/pipedal/svg/fx_parametric_eq.svg
    src/pipedal/svg/fx_simulator.svg
    src/pipedal/svg/fx_lr.svg
    src/pipedal/svg/fx_plugin.svg
    src/pipedal/svg/fx_flanger2.svg
    src/pipedal/svg/fx_phaser.svg
    src/pipedal/svg/ic_bank.svg
    src/pipedal/svg/fx_constant.svg
    src/pipedal/svg/snapshot_3.svg
    src/pipedal/svg/snapshot_0.svg
    src/pipedal/svg/fx_split_a.svg
    src/pipedal/svg/fx_chorus.svg
    src/pipedal/svg/fx_split_b.svg
    src/pipedal/svg/fx_terminal.svg
    src/pipedal/svg/ic_save_bank_as.svg
    src/pipedal/svg/fx_spectral.svg
    src/pipedal/svg/ic_settings.svg
    src/pipedal/svg/ic_pluginpreset2.svg
    src/pipedal/svg/fx_analyzer.svg
    src/pipedal/svg/fx_oscillator.svg
    src/pipedal/svg/fx_generator.svg
    src/pipedal/svg/snapshot_2.svg
    src/pipedal/svg/fx_converter.svg
    src/pipedal/svg/ic_midi.svg
    src/pipedal/svg/fx_pitch.svg
    src/pipedal/svg/fx_spatial.svg
    src/pipedal/svg/fx_limiter.svg
    src/pipedal/svg/fx_gate.svg
    src/pipedal/svg/ic_presets.svg
    src/pipedal/svg/snapshot_5.svg
    src/pipedal/svg/fx_modulator.svg
    src/pipedal/svg/snapshot_6.svg
    src/pipedal/svg/fx_filter_hp.svg
    src/pipedal/svg/fx_dial.svg
    src/pipedal/svg/ic_pluginpreset.svg
    src/pipedal/svg/fx_instrument.svg
    src/pipedal/svg/fx_flanger.svg
    src/pipedal/svg/file_download_black_24dp.svg
    src/pipedal/svg/snapshot_1.svg
    src/pipedal/svg/fx_empty.svg
    src/pipedal/svg/fx_mixer.svg
    src/pipedal/svg/ic_edit_banks.svg
    src/pipedal/svg/file_upload_black_24dp.svg
    src/pipedal/svg/fx_compressor.svg
    src/pipedal/svg/fx_amplifier.svg
    src/pipedal/svg/fx_filter.svg
    src/pipedal/svg/fx_eq.svg
    src/pipedal/svg/fx_utility.svg
    src/pipedal/svg/fx_function.svg
    src/pipedal/svg/snapshot_4.svg
    src/pipedal/svg/fx_reverb.svg
    src/pipedal/svg/fx_distortion.svg
    src/pipedal/svg/ic_help_outline.svg
    src/pipedal/AppThemed.css
    src/pipedal/AboutDialog.tsx
    src/pipedal/SettingsDialog.tsx
    src/pipedal/PluginControlView.tsx
    src/pipedal/VirtualKeyboardHandler.tsx
    src/pipedal/react-app-env.d.ts
    src/pipedal/DialogEx.tsx
    src/pipedal/ToobInputStageView.tsx
    src/pipedal/UpdateDialog.tsx
    src/pipedal/UploadPresetDialog.tsx
    src/pipedal/SnapshotButton.tsx
    src/pipedal/GxTunerView.tsx
    src/pipedal/SnapshotColors.tsx
    src/pipedal/MidiChannelBindingControl.tsx
    src/pipedal/DarkMode.tsx
    src/pipedal/PluginInfoDialog.tsx
    src/pipedal/ToobCabSimView.tsx
    src/pipedal/Jack.tsx
    src/pipedal/SnapshotEditor.tsx
    src/pipedal/ControlViewFactory.tsx
    src/pipedal/MidiBindingsDialog.tsx
    src/pipedal/SplitControlView.tsx
    src/pipedal/PiPedalError.tsx
    src/pipedal/XxxSnippet.tsx
    src/pipedal/SearchControl.tsx
    src/pipedal/PluginPreset.tsx
    src/pipedal/AlsaMidiDeviceInfo.tsx
    src/pipedal/PiPedalSocket.tsx
    src/pipedal/NoChangePassword.tsx
    src/pipedal/App.tsx
    src/pipedal/ObservableEvent.tsx
    src/pipedal/JackServerSettings.tsx
    src/pipedal/SnapshotPropertiesDialog.tsx
    src/pipedal/TextFieldEx.tsx
    src/pipedal/FilePropertyDialog.tsx
    src/pipedal/PresetDialog.tsx
    src/pipedal/SearchFilter.tsx
    src/pipedal/Units.tsx
    src/pipedal/AndroidHost.tsx
    src/pipedal/ToobPowerStage2View.tsx
    src/pipedal/Rectangle.tsx
    src/pipedal/PluginPresetsDialog.tsx
    src/pipedal/FilePropertyDirectoryTree.tsx
    src/pipedal/RenameDialog.tsx
    src/pipedal/PerformanceView.tsx
    src/pipedal/ToobFrequencyResponseView.tsx
    src/pipedal/MidiBindingView.tsx
    src/pipedal/SnapshotDialog.tsx
    src/pipedal/PluginIcon.tsx
    src/pipedal/JsonAtom.tsx
    src/pipedal/ToobToneStackView.tsx
    src/pipedal/logo.svg
    src/pipedal/ToobSpectrumResponseView.tsx
    src/pipedal/ZoomedDial.tsx
    src/pipedal/Draggable.tsx
    src/pipedal/DraggableGrid.tsx
    src/pipedal/WifiDirectConfigDialog.tsx
    src/pipedal/SvgPathBuilder.tsx
    src/pipedal/PresetSelector.tsx
    src/pipedal/SystemMidiBindingsDialog.tsx
    src/pipedal/OptionsDialog.tsx
    src/pipedal/Updater.tsx
    src/App.css
    package.json
    package-lock.json
    tsconfig.app.json
    tsconfig.json
    tsconfig.node.json
    vite.config.ts
    
)

add_custom_target (
    ReactBuild ALL
    DEPENDS ${BUILD_DIRECTORY}/index.html
)
